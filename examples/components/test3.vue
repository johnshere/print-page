<template>
  <PrintPage ref="printRef" :model-value="options" fileName="测试" :sign="{
    managerSignShow: false,
    otherSignShow: false,
    expertSignShow: false,
  }" :columns :data class="test">
    <PrintPageBreak />
    <table style="border-collapse: collapse;page-break-before:always">
      <thead>
        <tr>
          <th colspan="2" style="font-size: 14pt;">
            jzxtpxuqiu87020221213/01 竞争性谈判测试zly20221213 标段（包）01
            <br> 符合项1
          </th>
        </tr>
        <tr>
          <th colspan="2" style="text-align: left;"> 项目编号：jzxtpxuqiu87020221213/01 文件开启时间：2022-12-14 09:50</th>
        </tr>
        <tr>
          <th colspan="1"> 评审项 </th>
          <th class="">化工类企业2zly1</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="1" rowspan="1">符合1</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td colspan="1">评审结果</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; opacity: 1;"> 评标委员（专家3）： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
      </tbody><br>
    </table>
    <PrintPageBreak />
    <table style="border-collapse: collapse;page-break-before:always">
      <thead>
        <tr>
          <th colspan="2" style="font-size: 14pt;">jzxtpxuqiu87020221213/01 竞争性谈判测试zly20221213 标段（包）01 <br> 符合项1</th>
        </tr>
        <tr>
          <th colspan="2" style="text-align: left;"> 项目编号：jzxtpxuqiu87020221213/01 文件开启时间：2022-12-14 09:50</th>
        </tr>
        <tr>
          <th colspan="1"> 评审项 </th>
          <th class="">化工类企业2zly1</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="1" rowspan="1">符合1</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td colspan="1">评审结果</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; opacity: 1;"> 评标委员（专家2）： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
      </tbody><br>
    </table>
    <table style="border-collapse: collapse;">
      <thead>
        <tr>
          <th colspan="2" style="font-size: 14pt;">jzxtpxuqiu87020221213/01 竞争性谈判测试zly20221213 标段（包）01 <br> 符合项1</th>
        </tr>
        <tr>
          <th colspan="2" style="text-align: left;"> 项目编号：jzxtpxuqiu87020221213/01 文件开启时间：2022-12-14 09:50</th>
        </tr>
        <tr>
          <th colspan="1"> 评审项 </th>
          <th class="">化工类企业2zly1</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="1" rowspan="1">符合1</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td colspan="1">评审结果</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; opacity: 1;"> 评标委员（专家1）： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
      </tbody><br>
    </table>
    <page-break />
    <table style="border-collapse: collapse;">
      <thead>
        <tr>
          <th colspan="2" style="font-size: 14pt;">jzxtpxuqiu87020221213/01 竞争性谈判测试zly20221213 标段（包）01 <br> 符合项1</th>
        </tr>
        <tr>
          <th colspan="2" style="text-align: left;"> 项目编号：jzxtpxuqiu87020221213/01 文件开启时间：2022-12-14 09:50</th>
        </tr>
        <tr>
          <th colspan="1"> 评审项 </th>
          <th class="">化工类企业2zly1</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="1" rowspan="1">符合1</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td colspan="1">评审结果</td>
          <td class=""><span class="success-color">符合</span></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;"> 项目负责人签字： </td>
          <td colspan="1" style="text-align: left; line-height: 3.5;"></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px; border-top-width: 1px;">
            <div style="display: inline; opacity: 1;"> 其他人员签字： </div>
          </td>
          <td style="border-top-width: 1px; border-right-width: 1px;"></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; opacity: 1;"> 专家签字： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; color: transparent; opacity: 0;"> 专家签字： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
        <tr>
          <td style="text-align: left; line-height: 3.5; border-right-width: 0px;">
            <div style="display: inline; color: transparent; opacity: 0;"> 专家签字： </div>
          </td>
          <td style="border-right-width: 1px;"></td>
        </tr>
      </tbody><br>
    </table>
  </PrintPage>
</template>
<script lang="ts" setup>
import '@/style.scss';
import PrintPage, { PrintPageBreak } from '@/index.ts';
import type { TableColumns, Options } from '@/types.d.ts';

const printRef = ref<InstanceType<typeof PrintPage>>();

const options = reactive<Options>({});
const data = ref<any[]>([]);
const columns: TableColumns<any> = [
  {
    title: '序号',
    type: 'index',
  },
  {
    title: '编号',
    prop: 'number',
  },
  {
    title: '名称',
    prop: 'name',
  },
  {
    title: '电费',
    prop: 'fee',
  },
  {
    title: '电饭锅',
    prop: 'r',
  },
];

window.addEventListener('message', function (data) {
  console.log(data);
});
onMounted(async () => {
  await nextTick();
  printRef.value?.drawA4Paper();
  setTimeout(() => {
    if (location.href.includes('excelImmediate')) {
      printRef.value?.generateExcel();
    }
    if (location.href.includes('pdfImmediate')) {
      printRef.value?.generatePdf();
    }
  }, 300);
});
// if (window.top === window) {
//   setTimeout(() => {
//     const iframe = document.createElement('iframe');
//     iframe.src = location.href + '?excelImmediate=1&saved=tttt';
//     iframe.style.position = 'absolute';
//     iframe.style.width = '400mm';
//     iframe.style.left = '-500mm';
//     document.body.appendChild(iframe);
//   }, 4000);
// }
const complete = () => {
  console.log('完成');
};
</script>
<style lang="scss">
.test .print-page_origin {
  left: 0!important;
}
</style>
